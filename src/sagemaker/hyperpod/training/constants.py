# TODO: currently there is no API for instances and they are hardcoded; post GA work with partner team on adding support for such API
INSTANCE_RESOURCES = {
    "ml.p4d.24xlarge": {"cpu": 96, "gpu": 8, "trainium": 0, "memory": 1152, "efa": 4},
    "ml.p4de.24xlarge": {"cpu": 96, "gpu": 8, "trainium": 0, "memory": 1152, "efa": 4},
    "ml.p5.48xlarge": {"cpu": 192, "gpu": 8, "trainium": 0, "memory": 2048, "efa": 32},
    "ml.p5.4xlarge": {"cpu": 16, "gpu": 1, "trainium": 0, "memory": 256, "efa": 1},
    "ml.trn1.32xlarge": {"cpu": 128, "gpu": 0, "trainium": 16, "memory": 512, "efa": 8},
    "ml.trn1n.32xlarge": {"cpu": 128, "gpu": 0, "trainium": 16, "memory": 512, "efa": 16},
    "ml.g5.xlarge": {"cpu": 4, "gpu": 1, "trainium": 0, "memory": 16, "efa": 0},
    "ml.g5.2xlarge": {"cpu": 8, "gpu": 1, "trainium": 0, "memory": 32, "efa": 0},
    "ml.g5.4xlarge": {"cpu": 16, "gpu": 1, "trainium": 0, "memory": 64, "efa": 0},
    "ml.g5.8xlarge": {"cpu": 32, "gpu": 1, "trainium": 0, "memory": 128, "efa": 1},
    "ml.g5.12xlarge": {"cpu": 48, "gpu": 4, "trainium": 0, "memory": 192, "efa": 1},
    "ml.g5.16xlarge": {"cpu": 64, "gpu": 1, "trainium": 0, "memory": 256, "efa": 1},
    "ml.g5.24xlarge": {"cpu": 96, "gpu": 4, "trainium": 0, "memory": 384, "efa": 1},
    "ml.g5.48xlarge": {"cpu": 192, "gpu": 8, "trainium": 0, "memory": 768, "efa": 1},
    "ml.g6.xlarge": {"cpu": 4, "gpu": 1, "trainium": 0, "memory": 16, "efa": 0},
    "ml.g6.2xlarge": {"cpu": 8, "gpu": 1, "trainium": 0, "memory": 32, "efa": 0},
    "ml.g6.4xlarge": {"cpu": 16, "gpu": 1, "trainium": 0, "memory": 64, "efa": 0},
    "ml.g6.8xlarge": {"cpu": 32, "gpu": 1, "trainium": 0, "memory": 128, "efa": 1},
    "ml.g6.16xlarge": {"cpu": 64, "gpu": 1, "trainium": 0, "memory": 256, "efa": 1},
    "ml.g6.12xlarge": {"cpu": 48, "gpu": 4, "trainium": 0, "memory": 192, "efa": 1},
    "ml.g6.24xlarge": {"cpu": 96, "gpu": 4, "trainium": 0, "memory": 384, "efa": 1},
    "ml.g6.48xlarge": {"cpu": 192, "gpu": 8, "trainium": 0, "memory": 768, "efa": 1},
    "ml.gr6.4xlarge": {"cpu": 16, "gpu": 1, "trainium": 0, "memory": 128, "efa": 0},
    "ml.gr6.8xlarge": {"cpu": 32, "gpu": 1, "trainium": 0, "memory": 256, "efa": 1},
    "ml.g6e.xlarge": {"cpu": 4, "gpu": 1, "trainium": 0, "memory": 32, "efa": 0},
    "ml.g6e.2xlarge": {"cpu": 8, "gpu": 1, "trainium": 0, "memory": 64, "efa": 0},
    "ml.g6e.4xlarge": {"cpu": 16, "gpu": 1, "trainium": 0, "memory": 128, "efa": 0},
    "ml.g6e.8xlarge": {"cpu": 32, "gpu": 1, "trainium": 0, "memory": 256, "efa": 1},
    "ml.g6e.16xlarge": {"cpu": 64, "gpu": 1, "trainium": 0, "memory": 512, "efa": 1},
    "ml.g6e.12xlarge": {"cpu": 48, "gpu": 4, "trainium": 0, "memory": 384, "efa": 1},
    "ml.g6e.24xlarge": {"cpu": 96, "gpu": 4, "trainium": 0, "memory": 768, "efa": 2},
    "ml.g6e.48xlarge": {"cpu": 192, "gpu": 8, "trainium": 0, "memory": 1536, "efa": 4},
    "ml.p5e.48xlarge": {"cpu": 192, "gpu": 8, "trainium": 0, "memory": 2048, "efa": 32},
    "ml.p5en.48xlarge": {"cpu": 192, "gpu": 8, "trainium": 0, "memory": 2048, "efa": 16},
    "ml.trn2.48xlarge": {"cpu": 192, "gpu": 0, "trainium": 16, "memory": 2048, "efa": 0},
    "ml.p6e-gb200.36xlarge": {"cpu": 144, "gpu": 4, "trainium": 0, "memory": 960, "efa": 0},
    "ml.p6-b200.48xlarge": {"cpu": 192, "gpu": 8, "trainium": 0, "memory": 2024, "efa": 8},
    "ml.c5.large": {"cpu": 2, "gpu": 0, "trainium": 0, "memory": 4, "efa": 0},
    "ml.c5.xlarge": {"cpu": 4, "gpu": 0, "trainium": 0, "memory": 8, "efa": 0},
    "ml.c5.2xlarge": {"cpu": 8, "gpu": 0, "trainium": 0, "memory": 16, "efa": 0},
    "ml.c5.4xlarge": {"cpu": 16, "gpu": 0, "trainium": 0, "memory": 32, "efa": 0},
    "ml.c5.9xlarge": {"cpu": 36, "gpu": 0, "trainium": 0, "memory": 72, "efa": 0},
    "ml.c5.12xlarge": {"cpu": 48, "gpu": 0, "trainium": 0, "memory": 96, "efa": 0},
    "ml.c5.18xlarge": {"cpu": 72, "gpu": 0, "trainium": 0, "memory": 144, "efa": 0},
    "ml.c5.24xlarge": {"cpu": 96, "gpu": 0, "trainium": 0, "memory": 192, "efa": 0},
    "ml.c5n.large": {"cpu": 2, "gpu": 0, "trainium": 0, "memory": 5, "efa": 0},
    "ml.c5n.2xlarge": {"cpu": 8, "gpu": 0, "trainium": 0, "memory": 21, "efa": 0},
    "ml.c5n.4xlarge": {"cpu": 16, "gpu": 0, "trainium": 0, "memory": 42, "efa": 0},
    "ml.c5n.9xlarge": {"cpu": 36, "gpu": 0, "trainium": 0, "memory": 96, "efa": 1},
    "ml.c5n.18xlarge": {"cpu": 72, "gpu": 0, "trainium": 0, "memory": 192, "efa": 1},
    "ml.m5.large": {"cpu": 2, "gpu": 0, "trainium": 0, "memory": 8, "efa": 0},
    "ml.m5.xlarge": {"cpu": 4, "gpu": 0, "trainium": 0, "memory": 16, "efa": 0},
    "ml.m5.2xlarge": {"cpu": 8, "gpu": 0, "trainium": 0, "memory": 32, "efa": 0},
    "ml.m5.4xlarge": {"cpu": 16, "gpu": 0, "trainium": 0, "memory": 64, "efa": 0},
    "ml.m5.8xlarge": {"cpu": 32, "gpu": 0, "trainium": 0, "memory": 128, "efa": 0},
    "ml.m5.12xlarge": {"cpu": 48, "gpu": 0, "trainium": 0, "memory": 192, "efa": 0},
    "ml.m5.16xlarge": {"cpu": 64, "gpu": 0, "trainium": 0, "memory": 256, "efa": 0},
    "ml.m5.24xlarge": {"cpu": 96, "gpu": 0, "trainium": 0, "memory": 384, "efa": 0},
    "ml.t3.medium": {"cpu": 2, "gpu": 0, "trainium": 0, "memory": 4, "efa": 0},
    "ml.t3.large": {"cpu": 2, "gpu": 0, "trainium": 0, "memory": 8, "efa": 0},
    "ml.t3.xlarge": {"cpu": 4, "gpu": 0, "trainium": 0, "memory": 16, "efa": 0},
    "ml.t3.2xlarge": {"cpu": 8, "gpu": 0, "trainium": 0, "memory": 32, "efa": 0},
    "ml.c6i.large": {"cpu": 2, "gpu": 0, "trainium": 0, "memory": 4, "efa": 0},
    "ml.c6i.xlarge": {"cpu": 4, "gpu": 0, "trainium": 0, "memory": 8, "efa": 0},
    "ml.c6i.2xlarge": {"cpu": 8, "gpu": 0, "trainium": 0, "memory": 16, "efa": 0},
    "ml.c6i.4xlarge": {"cpu": 16, "gpu": 0, "trainium": 0, "memory": 32, "efa": 0},
    "ml.c6i.8xlarge": {"cpu": 32, "gpu": 0, "trainium": 0, "memory": 64, "efa": 0},
    "ml.c6i.12xlarge": {"cpu": 48, "gpu": 0, "trainium": 0, "memory": 96, "efa": 0},
    "ml.c6i.16xlarge": {"cpu": 64, "gpu": 0, "trainium": 0, "memory": 128, "efa": 0},
    "ml.c6i.24xlarge": {"cpu": 96, "gpu": 0, "trainium": 0, "memory": 192, "efa": 0},
    "ml.c6i.32xlarge": {"cpu": 128, "gpu": 0, "trainium": 0, "memory": 256, "efa": 1},
    "ml.m6i.large": {"cpu": 2, "gpu": 0, "trainium": 0, "memory": 8, "efa": 0},
    "ml.m6i.xlarge": {"cpu": 4, "gpu": 0, "trainium": 0, "memory": 16, "efa": 0},
    "ml.m6i.2xlarge": {"cpu": 8, "gpu": 0, "trainium": 0, "memory": 32, "efa": 0},
    "ml.m6i.4xlarge": {"cpu": 16, "gpu": 0, "trainium": 0, "memory": 64, "efa": 0},
    "ml.m6i.8xlarge": {"cpu": 32, "gpu": 0, "trainium": 0, "memory": 128, "efa": 0},
    "ml.m6i.12xlarge": {"cpu": 48, "gpu": 0, "trainium": 0, "memory": 192, "efa": 0},
    "ml.m6i.16xlarge": {"cpu": 64, "gpu": 0, "trainium": 0, "memory": 256, "efa": 0},
    "ml.m6i.24xlarge": {"cpu": 96, "gpu": 0, "trainium": 0, "memory": 384, "efa": 0},
    "ml.m6i.32xlarge": {"cpu": 128, "gpu": 0, "trainium": 0, "memory": 512, "efa": 1},
    "ml.r6i.large": {"cpu": 2, "gpu": 0, "trainium": 0, "memory": 16, "efa": 0},
    "ml.r6i.xlarge": {"cpu": 4, "gpu": 0, "trainium": 0, "memory": 32, "efa": 0},
    "ml.r6i.2xlarge": {"cpu": 8, "gpu": 0, "trainium": 0, "memory": 64, "efa": 0},
    "ml.r6i.4xlarge": {"cpu": 16, "gpu": 0, "trainium": 0, "memory": 128, "efa": 0},
    "ml.r6i.8xlarge": {"cpu": 32, "gpu": 0, "trainium": 0, "memory": 256, "efa": 0},
    "ml.r6i.12xlarge": {"cpu": 48, "gpu": 0, "trainium": 0, "memory": 384, "efa": 0},
    "ml.r6i.16xlarge": {"cpu": 64, "gpu": 0, "trainium": 0, "memory": 512, "efa": 0},
    "ml.r6i.24xlarge": {"cpu": 96, "gpu": 0, "trainium": 0, "memory": 768, "efa": 0},
    "ml.r6i.32xlarge": {"cpu": 128, "gpu": 0, "trainium": 0, "memory": 1024, "efa": 1},
    "ml.m7i.large": {"cpu": 2, "gpu": 0, "trainium": 0, "memory": 8, "efa": 0},
    "ml.m7i.xlarge": {"cpu": 4, "gpu": 0, "trainium": 0, "memory": 16, "efa": 0},
    "ml.m7i.2xlarge": {"cpu": 8, "gpu": 0, "trainium": 0, "memory": 32, "efa": 0},
    "ml.m7i.4xlarge": {"cpu": 16, "gpu": 0, "trainium": 0, "memory": 64, "efa": 0},
    "ml.m7i.8xlarge": {"cpu": 32, "gpu": 0, "trainium": 0, "memory": 128, "efa": 0},
    "ml.m7i.12xlarge": {"cpu": 48, "gpu": 0, "trainium": 0, "memory": 192, "efa": 0},
    "ml.m7i.16xlarge": {"cpu": 64, "gpu": 0, "trainium": 0, "memory": 256, "efa": 0},
    "ml.m7i.24xlarge": {"cpu": 96, "gpu": 0, "trainium": 0, "memory": 384, "efa": 0},
    "ml.m7i.48xlarge": {"cpu": 192, "gpu": 0, "trainium": 0, "memory": 768, "efa": 1},
    "ml.r7i.large": {"cpu": 2, "gpu": 0, "trainium": 0, "memory": 16, "efa": 0},
    "ml.r7i.xlarge": {"cpu": 4, "gpu": 0, "trainium": 0, "memory": 32, "efa": 0},
    "ml.r7i.2xlarge": {"cpu": 8, "gpu": 0, "trainium": 0, "memory": 64, "efa": 0},
    "ml.r7i.4xlarge": {"cpu": 16, "gpu": 0, "trainium": 0, "memory": 128, "efa": 0},
    "ml.r7i.8xlarge": {"cpu": 32, "gpu": 0, "trainium": 0, "memory": 256, "efa": 0},
    "ml.r7i.12xlarge": {"cpu": 48, "gpu": 0, "trainium": 0, "memory": 384, "efa": 0},
    "ml.r7i.16xlarge": {"cpu": 64, "gpu": 0, "trainium": 0, "memory": 512, "efa": 0},
    "ml.r7i.24xlarge": {"cpu": 96, "gpu": 0, "trainium": 0, "memory": 768, "efa": 0},
    "ml.r7i.48xlarge": {"cpu": 192, "gpu": 0, "trainium": 0, "memory": 1536, "efa": 1},
    "ml.i3en.large": {"cpu": 2, "gpu": 0, "trainium": 0, "memory": 16, "efa": 0},
    "ml.i3en.xlarge": {"cpu": 4, "gpu": 0, "trainium": 0, "memory": 32, "efa": 0},
    "ml.i3en.2xlarge": {"cpu": 8, "gpu": 0, "trainium": 0, "memory": 64, "efa": 0},
    "ml.i3en.3xlarge": {"cpu": 12, "gpu": 0, "trainium": 0, "memory": 96, "efa": 0},
    "ml.i3en.6xlarge": {"cpu": 24, "gpu": 0, "trainium": 0, "memory": 192, "efa": 0},
    "ml.i3en.12xlarge": {"cpu": 48, "gpu": 0, "trainium": 0, "memory": 384, "efa": 1},
    "ml.i3en.24xlarge": {"cpu": 96, "gpu": 0, "trainium": 0, "memory": 768, "efa": 1}
}

# MIG profiles by instance type
INSTANCE_TYPE_MIG_PROFILES = {
    'ml.p4d.24xlarge': ['mig-1g.5gb', 'mig-1g.10gb', 'mig-2g.10gb', 'mig-3g.20gb', 'mig-4g.20gb', 'mig-7g.40gb'],
    'ml.p4de.24xlarge': ['mig-1g.10gb', 'mig-1g.20gb', 'mig-2g.20gb', 'mig-3g.40gb', 'mig-4g.40gb', 'mig-7g.80gb'],
    'ml.p5.48xlarge': ['mig-1g.10gb', 'mig-1g.20gb', 'mig-2g.20gb', 'mig-3g.40gb', 'mig-4g.40gb', 'mig-7g.80gb'],
    'ml.p5e.48xlarge': ['mig-1g.18gb', 'mig-1g.35gb', 'mig-2g.35gb', 'mig-3g.71gb', 'mig-4g.71gb', 'mig-7g.141gb'],
    'ml.p5en.48xlarge': ['mig-1g.18gb', 'mig-1g.35gb', 'mig-2g.35gb', 'mig-3g.71gb', 'mig-4g.71gb', 'mig-7g.141gb'],
    'p6-b200.48xlarge': ['mig-1g.23gb', 'mig-1g.45gb', 'mig-2g.45gb', 'mig-3g.90gb', 'mig-4g.90gb', 'mig-7g.180gb'],
    'ml.p6e-gb200.36xlarge': ['mig-1g.23gb', 'mig-1g.47gb', 'mig-2g.47gb', 'mig-3g.93gb', 'mig-4g.93gb', 'mig-7g.186gb']
}

ALLOWED_ACCELERATOR_PARTITION_TYPES = set().union(*INSTANCE_TYPE_MIG_PROFILES.values())
VALIDATE_PROFILE_IN_CLUSTER = "VALIDATE_PROFILE_IN_CLUSTER"